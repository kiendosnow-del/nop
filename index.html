<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SNOW SHOP ‚Äî Thu√™ c√†y Blox Fruits (Admin & N·∫°p Bank)</title>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#051024; --panel:#071226; --muted:#9aa3af; --text:#e6eef6;
  --accent:#06b6d4; --accent-2:#60a5fa; --success:#10b981; --danger:#ef4444;
  --glass: rgba(255,255,255,0.02); --radius:12px; --shadow: 0 10px 30px rgba(2,6,23,0.6);
  --max-width:1200px; --card-gap:14px; --transition:200ms;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
  background:linear-gradient(180deg,var(--bg),#03101d 150%);color:var(--text);
  -webkit-font-smoothing:antialiased;line-height:1.45;
}

/* Layout */
.header{max-width:var(--max-width);margin:18px auto;padding:14px 18px;display:flex;align-items:center;justify-content:space-between;gap:12px}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#2563eb);display:flex;align-items:center;justify-content:center;font-weight:800;color:#021022;box-shadow:var(--shadow);font-size:20px}
.title{font-weight:700}
.header-info{display:flex;gap:12px;align-items:center;font-size:14px;color:var(--muted)}

.nav{max-width:var(--max-width);margin:0 auto;padding:8px 18px 0;display:flex;gap:8px;justify-content:center}
.nav button{background:transparent;border:0;color:var(--muted);padding:8px 12px;border-radius:10px;font-weight:600;cursor:pointer;transition:color var(--transition), background var(--transition)}
.nav button[aria-current="true"], .nav button:hover{ color:var(--text); background:var(--glass) }

.main{max-width:var(--max-width);margin:18px auto;padding:18px;display:grid;grid-template-columns: 1fr 360px;gap:18px}
@media (max-width:980px){ .main{ grid-template-columns:1fr } }

.panel{background:linear-gradient(180deg,var(--panel),#061224);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow);border:1px solid rgba(255,255,255,0.03)}

.hero{display:flex;justify-content:space-between;gap:16px;align-items:center;padding:12px;border-radius:10px;background:linear-gradient(90deg,rgba(6,182,212,0.05),rgba(58,123,213,0.03))}
.hero h1{margin:0;font-size:20px}
.hero p{margin:6px 0 0;color:var(--muted);font-size:14px}

.controls{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
.controls input, .controls select{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--text);padding:10px;border-radius:10px;width:100%}
.controls .col{min-width:160px;flex:1}

/* Packages grid */
.grid{margin-top:16px;display:grid;grid-template-columns: repeat(3, 1fr);gap:var(--card-gap)}
@media (max-width:980px){ .grid{ grid-template-columns: repeat(2,1fr) } }
@media (max-width:640px){ .grid{ grid-template-columns:1fr } }

.card-item{background:linear-gradient(180deg, rgba(255,255,255,0.015), transparent);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);transition: transform var(--transition), box-shadow var(--transition);will-change: transform}
.card-item:hover{ transform: translateY(-6px); box-shadow: 0 20px 40px rgba(2,6,23,0.6) }
.pkg-head{display:flex;justify-content:space-between;align-items:center;gap:8px}
.pkg-name{font-weight:800}
.pkg-price{font-weight:800;color:var(--accent)}
.features{margin-top:10px;display:flex;flex-direction:column;gap:6px;color:var(--muted);font-size:13px}
.feature{display:flex;gap:8px;align-items:flex-start}
.feature .dot{width:8px;height:8px;border-radius:50%;background:linear-gradient(90deg,var(--accent),var(--accent-2));margin-top:6px}
.actions-row{display:flex;gap:8px;margin-top:12px}
.btn{border:0;padding:10px 12px;border-radius:10px;font-weight:700;cursor:pointer;color:#021022;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition: transform var(--transition)}
.btn.secondary{ background:transparent;color:var(--text); border:1px solid rgba(255,255,255,0.04) }
.btn:active{ transform: translateY(1px) }

/* Sidebar */
.sidebar{display:flex;flex-direction:column;gap:12px}
.wallet .balance{font-weight:800;color:var(--accent);font-size:18px;margin-top:8px}
.orders-preview .order-small{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:var(--glass);margin-bottom:8px}

/* Modal / toast */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;z-index:60}
.modal{width:100%;max-width:760px;background:linear-gradient(180deg,#071022,#05101a);padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 20px 40px rgba(0,0,0,0.7)}
.toast-wrap{position:fixed;right:18px;bottom:18px;display:flex;flex-direction:column;gap:8px;z-index:70}

.kv{color:var(--muted);font-size:13px}
.small{font-size:13px;color:var(--muted)}
.hidden{display:none}
.admin-badge{background:linear-gradient(90deg,#facc15,#eab308);color:#021022;padding:6px 8px;border-radius:999px;font-weight:700}
</style>
</head>

<body>
  <header class="header" role="banner">
    <div class="brand">
      <div class="logo" aria-hidden>SS</div>
      <div>
        <div class="title">SNOW SHOP</div>
        <div class="kv">Thu√™ c√†y Blox Fruits ‚Äî Uy t√≠n ‚Ä¢ Nhanh ‚Ä¢ An to√†n</div>
      </div>
    </div>

    <div class="header-info" aria-hidden>
      <div>üë§ <strong id="hdr-user">Ch∆∞a ƒëƒÉng nh·∫≠p</strong> <span id="hdr-admin" class="admin-badge hidden">ADMIN</span></div>
      <div>üí∞ <strong id="hdr-balance">0ƒë</strong></div>
    </div>
  </header>

  <nav class="nav" role="navigation" aria-label="Ch√≠nh">
    <button data-tab="packages" aria-current="true">G√≥i d·ªãch v·ª•</button>
    <button data-tab="account">T√†i kho·∫£n</button>
    <button data-tab="orders">L·ªãch s·ª≠</button>
    <button id="nav-deposit">N·∫°p ti·ªÅn</button>
    <button id="contactBtn">Li√™n h·ªá</button>
  </nav>

  <main class="main" role="main">
    <section class="panel" aria-labelledby="hero-title">
      <div class="hero" id="hero">
        <div>
          <h1 id="hero-title">Thu√™ c√†y chuy√™n nghi·ªáp ‚Äî An to√†n & Nhanh</h1>
          <p>Ch·ªçn g√≥i ch√≠nh x√°c theo nhu c·∫ßu ‚Äî thanh to√°n b·∫±ng v√≠ ho·∫∑c n·∫°p ng√¢n h√†ng. Admin c√≥ quy·ªÅn qu·∫£n l√Ω n·∫°p v√† gift ti·ªÅn.</p>
          <div style="margin-top:10px">
            <button class="btn" id="cta-order">Mua ngay</button>
            <button class="btn secondary" id="cta-learn">C√°ch ho·∫°t ƒë·ªông</button>
          </div>
        </div>
        <div style="text-align:right">
          <div class="kv">H·ªó tr·ª£ 24/7</div>
          <div style="margin-top:10px" class="kv">Cam k·∫øt ho√†n ti·ªÅn n·∫øu vi ph·∫°m</div>
        </div>
      </div>

      <div class="controls" aria-hidden>
        <input id="searchInput" placeholder="T√¨m ki·∫øm g√≥i (Level/Tushita/Yama...)" class="col" />
        <select id="sortSelect" class="col" aria-label="S·∫Øp x·∫øp">
          <option value="popular">M·∫∑c ƒë·ªãnh</option>
          <option value="price_asc">Gi√° tƒÉng d·∫ßn</option>
          <option value="price_desc">Gi√° gi·∫£m d·∫ßn</option>
        </select>
      </div>

      <div id="packagesGrid" class="grid" aria-live="polite" aria-label="Danh s√°ch g√≥i"></div>
    </section>

    <aside class="sidebar">
      <div class="panel wallet">
        <div class="kv">T√†i kho·∫£n</div>
        <div id="acctName" class="kv" style="margin-top:6px">B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p</div>
        <div id="balance" class="balance">0ƒë</div>

        <div style="display:flex;gap:8px;margin-top:12px">
          <button class="btn" id="openAccount">ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω</button>
          <button class="btn secondary" id="quickBuy">ƒê·∫∑t nhanh</button>
        </div>

        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn secondary" id="openDeposit">N·∫°p ti·ªÅn</button>
        </div>
      </div>

      <div class="panel orders-preview">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <strong>ƒê∆°n g·∫ßn ƒë√¢y</strong>
          <button class="small" id="viewOrders">Xem t·∫•t c·∫£</button>
        </div>
        <div id="ordersPreview" style="margin-top:12px"></div>
      </div>

      <div id="adminPanelPlaceholder" class="panel hidden">
        <strong>Admin</strong>
        <div style="margin-top:8px">
          <button class="btn" id="openAdminPanel">B·∫£ng qu·∫£n tr·ªã</button>
        </div>
      </div>

      <div class="panel">
        <strong>H·ªó tr·ª£</strong>
        <div class="kv" style="margin-top:8px">Li√™n h·ªá: Discord / Telegram / Zalo</div>
        <div style="margin-top:12px"><button class="btn secondary" id="contactSupport">M·ªü k√™nh h·ªó tr·ª£</button></div>
      </div>
    </aside>
  </main>

  <div id="modalRoot" class="hidden" aria-hidden="true"></div>
  <div id="toastWrap" class="toast-wrap" aria-live="polite" aria-atomic="true"></div>

<script>
/*
  Enhancements added:
  - Admin account (admin/admin) with admin badge. Admin panel allows gifting money and approving/rejecting bank deposits.
  - Bank deposit flow: user creates deposit order with reference code, admin approves to credit balance.
  - Packages list reflects the provided <select> content (all groups included).
  - Order flow supports payment by wallet balance (auto-deduct) or pending payment if insufficient.
  - Optimized rendering, debounced search, event delegation, accessible modal & toasts.
  - All data kept in localStorage for demo. For production, replace backend endpoints (DISCORD_WEBHOOK) & persist server-side.
*/

const DISCORD_WEBHOOK = ""; // Should point to your backend endpoint that forwards to Discord

/* Packages (exact to user's provided list) */
const PACKAGES = [
  // LEVEL
  { id:'level_700', name:'Level 700', price:20000, time:'3‚Äì5 gi·ªù', desc:'Farm nhanh l√™n level 700', features:['Farm quest nhanh','Kh√¥ng ƒë·ªïi tr√°i','3‚Äì5 gi·ªù'] },
  { id:'700_1500', name:'700 ‚Üí 1500', price:20000, time:'1‚Äì2 ng√†y', desc:'Farm t·ª´ Sea 2', features:['Farm boss + quest','Kh√¥ng m·∫•t ƒë·ªì','1‚Äì2 ng√†y'] },
  { id:'1500_2800', name:'1500 ‚Üí 2800', price:20000, time:'2‚Äì3 ng√†y', desc:'Farm Sea 3', features:['Farm full Sea 3','An to√†n 100%','2‚Äì3 ng√†y'] },
  { id:'0_max', name:'0 ‚Üí MAX', price:50000, time:'4‚Äì6 ng√†y', desc:'C√†y t·ª´ ƒë·∫ßu t·ªõi max', features:['Full Sea 1‚Äì2‚Äì3','Kh√¥ng m·∫•t acc','4‚Äì6 ng√†y'] },
  // ITEM
  { id:'mo_ne', name:'M·ªè Neo', price:20000, time:'1 ng√†y', desc:'L√†m M·ªè Neo', features:['Full quest','Kh√¥ng m·∫•t ƒë·ªì','1 ng√†y'] },
  { id:'tushita', name:'Tushita', price:15000, time:'Trong ng√†y', desc:'Ki·∫øm Tushita', features:['Full quest','An to√†n','Trong ng√†y'] },
  { id:'yama', name:'Yama', price:30000, time:'1‚Äì2 ng√†y', desc:'Ki·∫øm Yama', features:['Full Yama','Kh√¥ng m·∫•t ƒë·ªì','1‚Äì2 ng√†y'] },
  { id:'tam_kiem', name:'Tam Ki·∫øm Full', price:35000, time:'2‚Äì3 ng√†y', desc:'True Triple Katana', features:['Full 3 ki·∫øm','Kh√¥ng rollback','2‚Äì3 ng√†y'] },
  { id:'cdk', name:'CDK', price:30000, time:'1‚Äì2 ng√†y', desc:'Cursed Dual Katana', features:['Full CDK','Kh√¥ng m·∫•t item','1‚Äì2 ng√†y'] },
  // V4
  { id:'full_v4', name:'Full Gear V4', price:30000, time:'1‚Äì2 ng√†y', desc:'Full Gear V4', features:['Full Gear','Th·ª©c t·ªânh V4','1‚Äì2 ng√†y'] },
  { id:'one_v4', name:'1 Gear V4', price:5000, time:'Trong ng√†y', desc:'Up 1 Gear', features:['1 Gear b·∫•t k·ª≥','Nhanh g·ªçn','Trong ng√†y'] },
  // MELEE
  { id:'godhuman', name:'Godhuman', price:20000, time:'1 ng√†y', desc:'Melee Godhuman', features:['Full Godhuman','Farm nguy√™n li·ªáu','1 ng√†y'] },
  { id:'melee_v2', name:'Melee V2', price:15000, time:'Trong ng√†y', desc:'Up Melee V2', features:['Melee V2','Nhanh','Trong ng√†y'] }
];

/* Storage wrapper with deposits + logs */
const Storage = {
  usersKey: 'snow_v4_users',
  ordersKey: 'snow_v4_orders',
  depositsKey: 'snow_v4_deposits',
  logsKey: 'snow_v4_logs',
  getUsers(){ try{return JSON.parse(localStorage.getItem(this.usersKey)||'{}')}catch(e){return{}} },
  saveUsers(v){ localStorage.setItem(this.usersKey, JSON.stringify(v)) },
  getOrders(){ try{return JSON.parse(localStorage.getItem(this.ordersKey)||'[]')}catch(e){return[]} },
  saveOrders(v){ localStorage.setItem(this.ordersKey, JSON.stringify(v)) },
  getDeposits(){ try{return JSON.parse(localStorage.getItem(this.depositsKey)||'[]')}catch(e){return[]} },
  saveDeposits(v){ localStorage.setItem(this.depositsKey, JSON.stringify(v)) },
  pushLog(entry){ const l = JSON.parse(localStorage.getItem(this.logsKey)||'[]'); l.unshift(entry); localStorage.setItem(this.logsKey, JSON.stringify(l)); }
};

/* Helpers */
const $ = sel => document.querySelector(sel);
const $$ = sel => Array.from(document.querySelectorAll(sel));
const fmt = n => (Number(n)||0).toLocaleString('vi-VN');
const now = () => Date.now();
async function sha256(msg){ const enc = new TextEncoder(); const buf = await crypto.subtle.digest('SHA-256', enc.encode(msg)); return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join(''); }
function escapeHtml(s){ if(s==null) return ''; return String(s).replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','
