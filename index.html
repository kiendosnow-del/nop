<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>â„ï¸ SNOW | CÃ y ThuÃª Blox Fruits</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#0f172a;color:#fff}
header{background:linear-gradient(135deg,#1e90ff,#00c6ff);padding:14px;text-align:center}
.container{max-width:520px;margin:auto;padding:14px}
.card{background:#fff;color:#000;border-radius:14px;padding:14px;margin-bottom:12px}
input,select,textarea,button{width:100%;padding:10px;margin:6px 0;border-radius:10px}
button{background:#1e90ff;color:#fff;border:none;font-weight:bold}
.price{font-size:18px;font-weight:bold;color:#1e90ff}
.hide{display:none}
</style>
</head>

<body>

<audio id="clickSound" src="https://assets.mixkit.co/sfx/preview/mixkit-coins-handling-1939.mp3"></audio>

<header>
<h2>â„ï¸ SNOW CÃ€Y THUÃŠ</h2>
<div id="userBox" class="hide">
ğŸ‘¤ <b id="uname"></b> | ğŸ’° <b id="wallet">0Ä‘</b>
<button onclick="logout()">ÄÄƒng xuáº¥t</button>
</div>
</header>

<div class="container">

<div class="card" id="loginBox">
<input id="lu" placeholder="TÃ i khoáº£n">
<input id="lp" type="password" placeholder="Máº­t kháº©u">
<button onclick="login()">ÄÄƒng nháº­p</button>
<button onclick="register()">ÄÄƒng kÃ½</button>
</div>

<div class="card hide" id="orderBox">
<select id="goi">
<option value="">-- Chá»n gÃ³i cÃ y thuÃª --</option>
<optgroup label="ğŸ”° LEVEL">
<option value="LV_700_1500">700 â†’ 1500 (20k)</option>
<option value="LV_1500_MAX">1500 â†’ MAX (20k)</option>
</optgroup>
<optgroup label="ğŸ§° ITEM">
<option value="CDK">CDK (30k)</option>
<option value="TAM_KIEM">Tam Kiáº¿m Full (35k)</option>
<option value="MO_NEO">Má» Neo (20k)</option>
</optgroup>
</select>

<div class="price">GiÃ¡: <span id="price">â€”</span></div>
<input id="rbx" placeholder="Nick Roblox">
<textarea id="note" placeholder="Ghi chÃº"></textarea>
<button onclick="buy()">ğŸ›’ Äáº¶T ÄÆ N</button>
</div>

<div class="card hide" id="cardBox">
<h3>ğŸ’³ Náº¡p tháº» cÃ o</h3>
<select id="cardType">
<option>VIETTEL</option>
<option>MOBIFONE</option>
<option>VINAPHONE</option>
</select>
<input id="cardAmount" placeholder="Má»‡nh giÃ¡ (10000)">
<input id="cardSerial" placeholder="Serial">
<input id="cardCode" placeholder="MÃ£ tháº»">
<button onclick="napCard()">Náº P THáºº</button>
</div>

<div class="card hide" id="bankBox">
<h3>ğŸ¦ Náº¡p Bank</h3>
<input id="bankAmount" placeholder="Sá»‘ tiá»n">
<input id="bankNote" placeholder="Ná»™i dung CK">
<button onclick="napBank()">Gá»¬I DUYá»†T</button>
</div>

</div>

<script>
const API="http://YOUR_VPS_IP:3000";
const click=()=>document.getElementById("clickSound").play();
let token="";

goi.onchange=async()=>{
 if(!goi.value) return price.innerText="â€”";
 const r=await fetch(API+"/pack/"+goi.value);
 const d=await r.json();
 if(!d.ok) return price.innerText="Lá»—i";
 price.innerText=d.price.toLocaleString()+"Ä‘";
}

async function login(){
 click();
 const r=await fetch(API+"/login",{method:"POST",headers:{'Content-Type':'application/json'},
 body:JSON.stringify({u:lu.value,p:lp.value})});
 const d=await r.json();
 if(!d.ok) return alert(d.msg);
 token=d.token;
 init(d.user);
}

async function register(){
 click();
 const r=await fetch(API+"/register",{method:"POST",headers:{'Content-Type':'application/json'},
 body:JSON.stringify({u:lu.value,p:lp.value})});
 alert((await r.json()).msg);
}

function logout(){location.reload()}

function init(u){
 loginBox.classList.add("hide");
 orderBox.classList.remove("hide");
 cardBox.classList.remove("hide");
 bankBox.classList.remove("hide");
 userBox.classList.remove("hide");
 uname.innerText=u.username;
 wallet.innerText=u.wallet.toLocaleString()+"Ä‘";
}

async function buy(){
 click();
 const r=await fetch(API+"/order",{method:"POST",
 headers:{'Content-Type':'application/json',Authorization:"Bearer "+token},
 body:JSON.stringify({pack:goi.value,roblox:rbx.value,note:note.value})});
 const d=await r.json();
 alert(d.msg);
 if(d.wallet!==undefined) wallet.innerText=d.wallet.toLocaleString()+"Ä‘";
}

async function napCard(){
 click();
 const r=await fetch(API+"/topup/card",{method:"POST",
 headers:{'Content-Type':'application/json',Authorization:"Bearer "+token},
 body:JSON.stringify({
 type:cardType.value,
 amount:+cardAmount.value,
 serial:cardSerial.value,
 code:cardCode.value
 })});
 const d=await r.json();
 alert(d.msg);
 if(d.wallet) wallet.innerText=d.wallet.toLocaleString()+"Ä‘";
}

async function napBank(){
 click();
 const r=await fetch(API+"/topup/bank",{method:"POST",
 headers:{'Content-Type':'application/json',Authorization:"Bearer "+token},
 body:JSON.stringify({amount:+bankAmount.value,note:bankNote.value})});
 alert((await r.json()).msg);
}
</script>

</body>
</html>
