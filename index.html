<!doctype html>
<html lang="vi">
<head>
    <meta charset="utf-8">
    <title>â„ï¸ SNOW SHOP â€” CÃ y ThuÃª Blox Fruits</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
        body{font-family:Arial,sans-serif;background:#f1f5f9;margin:0;padding-bottom:50px}
        .box{background:#fff;margin:12px;border-radius:12px;padding:14px;box-shadow:0 6px 16px rgba(0,0,0,.06)}
        button{background:#38bdf8;border:0;padding:10px 14px;border-radius:10px;font-weight:bold;margin:6px 0;cursor:pointer;transition:0.3s}
        button:hover{opacity:0.8}
        button.red{background:#ef4444;color:#fff}
        button.green{background:#22c55e;color:#fff}
        input,select{width:100%;padding:10px;margin:6px 0;border-radius:8px;border:1px solid #ddd;box-sizing:border-box}
        small{color:#555;display:block;margin-top:5px}
        hr{border:none;border-top:1px solid #eee;margin:15px 0}
        .info{background:#f8fafc;border:1px dashed #38bdf8;border-radius:10px;padding:10px;margin-top:10px;line-height:1.6}
        .info b{color:#0ea5e9}
        .qr-box{text-align:center;padding:15px;background:#fff;border-radius:10px;margin-top:10px}
        .admin-section{border-top:4px solid #ef4444}
    </style>
</head>
<body>

<div class="box">
    ğŸ‘¤ <b id="u">ChÆ°a Ä‘Äƒng nháº­p</b> | 
    ğŸ’° <b id="b">0</b>Ä‘ 
    <button class="red" onclick="logout()" style="float:right;padding:5px 10px">ÄÄƒng xuáº¥t</button>
</div>

<div class="box" id="auth_btns">
    <button onclick="auth()">ğŸ”‘ ÄÄƒng nháº­p / ÄÄƒng kÃ½</button>
    <button onclick="showDeposit()">ğŸ’³ Náº¡p tiá»n (QR)</button>
    <button id="adminBtn" class="red" style="display:none" onclick="showAdmin()">ğŸ›  Admin Panel</button>
</div>

<div class="box" id="main_shop">
    <h3>ğŸ›’ ThuÃª dá»‹ch vá»¥</h3>
    <select id="goi" onchange="showInfo()">
        <option value="">-- Chá»n gÃ³i cÃ y thuÃª --</option>
        <optgroup label="ğŸ”° LEVEL">
            <option value="Level 700|20000" data-info="Farm nhanh lÃªn level 700" data-detail="âœ” Farm quest nhanh<br>âœ” KhÃ´ng Ä‘á»•i trÃ¡i<br>âœ” 3â€“5 giá»">Level 700 â€“ 20.000Ä‘</option>
            <option value="0 â†’ MAX|50000" data-info="CÃ y tá»« Ä‘áº§u tá»›i max" data-detail="âœ” Full Sea 1â€“2â€“3<br>âœ” KhÃ´ng máº¥t acc<br>âœ” 4â€“6 ngÃ y">0 â†’ MAX â€“ 50.000Ä‘</option>
        </optgroup>
        <optgroup label="ğŸ’ ITEM">
            <option value="CDK|30000" data-info="Cursed Dual Katana" data-detail="âœ” Full CDK<br>âœ” KhÃ´ng máº¥t item<br>âœ” 1â€“2 ngÃ y">CDK â€“ 30.000Ä‘</option>
        </optgroup>
    </select>
    <div id="goiInfo" class="info" style="display:none"></div>
    <button class="green" style="width:100%;font-size:16px" onclick="order()">THUÃŠ NGAY (Trá»« tiá»n vÃ­)</button>
    <small>ğŸ“© ÄÆ¡n sáº½ Ä‘Æ°á»£c gá»­i qua Discord Admin</small>
</div>

<div class="box">
    <h3>ğŸ“œ Lá»‹ch sá»­ cá»§a tÃ´i</h3>
    <div id="his"></div>
</div>

<div id="adminPanel" class="box admin-section" style="display:none">
    <h3>ğŸ›  Quáº£n lÃ½ (Admin Only)</h3>
    <div id="adminList">Äang táº£i danh sÃ¡ch chá»...</div>
</div>

<div id="modal"></div>

<script>
// Cáº¥u hÃ¬nh
const DISCORD_WEBHOOK = "https://discord.com/api/webhooks/1465766093543964673/QfBdKIbYOgo5_s9S_YaJDF6vg6ZF8RyWwEw06uPZW3YtZuPUjCmODVJfdFmowfH1d9Gm";
let cur = null;

const u = document.getElementById('u');
const b = document.getElementById('b');
const goi = document.getElementById('goi');
const goiInfo = document.getElementById('goiInfo');
const modal = document.getElementById('modal');

/* HIá»‚N THá»Š THÃ”NG TIN GÃ“I */
function showInfo(){
    let s = goi.options[goi.selectedIndex];
    if(!s || !s.dataset.info){
        goiInfo.style.display="none";
        return;
    }
    goiInfo.style.display="block";
    goiInfo.innerHTML=`<b>ğŸ“Œ ${s.dataset.info}</b><br>${s.dataset.detail}`;
}

/* Náº P TIá»€N */
function showDeposit(){
    modal.innerHTML = `
    <div class="box" style="position:fixed;top:10%;left:5%;right:5%;z-index:100;background:#fff;border:2px solid #38bdf8">
        <h3>ğŸ’³ Náº¡p tiá»n qua NgÃ¢n hÃ ng / VÃ­</h3>
        <select id="bankSelect" onchange="updateQR()">
            <option value="MBBANK">MB Bank (QuÃ¢n Äá»™i)</option>
            <option value="MOMO">VÃ­ MoMo</option>
        </select>
        <input type="number" id="napAmount" placeholder="Nháº­p sá»‘ tiá»n muá»‘n náº¡p" oninput="updateQR()">
        <div class="qr-box" id="qrArea"><p>Nháº­p sá»‘ tiá»n Ä‘á»ƒ hiá»‡n mÃ£ QR</p></div>
        <button onclick="modal.innerHTML=''" style="width:100%">ÄÃ³ng</button>
    </div>`;
}

function updateQR(){
    const bank = document.getElementById('bankSelect').value;
    const amount = document.getElementById('napAmount').value;
    const user = cur ? cur.username : 'KHACH';
    const content = `NAP ${user}`;
    
    if(amount > 0) {
        const qrUrl = `https://img.vietqr.io/image/${bank}-123456789-compact2.png?amount=${amount}&addInfo=${content}`;
        document.getElementById('qrArea').innerHTML = `
            <img src="${qrUrl}" style="width:200px;border:1px solid #ddd">
            <p>Ná»™i dung: <b>${content}</b></p>
        `;
    }
}

/* Gá»¬I DISCORD */
async function sendDiscord(service, price) {
    const msg = {
        embeds: [{
            title: "ğŸ”¥ ÄÆ N CÃ€Y THUÃŠ Má»šI",
            color: 5814783,
            fields: [
                { name: "NgÆ°á»i Ä‘áº·t", value: cur.username, inline: true },
                { name: "Dá»‹ch vá»¥", value: service, inline: true },
                { name: "GiÃ¡ tiá»n", value: price + "Ä‘", inline: true }
            ],
            timestamp: new Date()
        }]
    };
    try {
        await fetch(DISCORD_WEBHOOK, { 
            method: 'POST', 
            headers: {'Content-Type': 'application/json'}, 
            body: JSON.stringify(msg)
        });
    } catch (e) { console.error("Discord error:", e); }
}

/* LOGIN GIáº¢ Láº¬P */
function auth(){
    modal.innerHTML=`<div class="box" style="position:fixed;top:20%;left:10%;right:10%;z-index:100;background:#fff;border:2px solid #38bdf8">
        <h3>ğŸ” ÄÄƒng nháº­p</h3>
        <input id="au" placeholder="TÃªn tÃ i khoáº£n">
        <input id="ap" type="password" placeholder="Máº­t kháº©u">
        <button onclick="login()" style="width:100%">VÃ o cá»­a hÃ ng</button>
        <button onclick="modal.innerHTML=''" class="red" style="width:100%">Há»§y</button>
    </div>`;
}

function login(){
    const userVal = document.getElementById('au').value;
    if(!userVal) return alert("Nháº­p tÃªn");
    cur = { username: userVal, balance: 100000, role: 'admin' };
    modal.innerHTML="";
    if(cur.role === 'admin') document.getElementById('adminBtn').style.display = 'inline-block';
    render();
}

/* Äáº¶T ÄÆ N */
async function order(){
    if(!cur) return alert("Vui lÃ²ng Ä‘Äƒng nháº­p!");
    if(!goi.value) return alert("Chá»n gÃ³i!");
    
    let [name, price] = goi.value.split("|");
    price = parseInt(price);

    if(cur.balance < price) return alert("KhÃ´ng Ä‘á»§ tiá»n!");

    cur.balance -= price;
    render();
    await sendDiscord(name, price);
    alert("ThÃ nh cÃ´ng! ÄÆ¡n Ä‘Ã£ gá»­i tá»›i Admin.");
    
    const h = document.getElementById('his');
    h.innerHTML = `<div>ğŸ“¦ ${name} â€” <b style="color:orange">Äang xá»­ lÃ½</b></div>` + h.innerHTML;
}

function render(){
    if(!cur){
        u.innerText="ChÆ°a Ä‘Äƒng nháº­p";
        b.innerText="0";
        return;
    }
    u.innerText=cur.username;
    b.innerText=cur.balance.toLocaleString();
}

function logout(){
    cur=null;
    document.getElementById('adminBtn').style.display = 'none';
    document.getElementById('adminPanel').style.display = 'none';
    render();
}

function showAdmin() {
    const p = document.getElementById('adminPanel');
    p.style.display = p.style.display === 'none' ? 'block' : 'none';
    document.getElementById('adminList').innerHTML = `<div class="info">Sáºµn sÃ ng nháº­n Ä‘Æ¡n!</div>`;
}
</script>

</body>
</html>
