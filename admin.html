<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ADMIN | SNOW</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:Arial;background:#eef3ff}
header{background:#1e90ff;color:#fff;padding:12px;text-align:center}
.container{max-width:720px;margin:auto;padding:14px}
.card{background:#fff;border-radius:12px;padding:12px;margin-bottom:10px}
.order{border-bottom:1px solid #eee;padding:8px 0}
button{padding:6px 10px;border:none;border-radius:6px;font-weight:bold;cursor:pointer}
.done{background:#2ecc71;color:#fff}
.refund{background:#e74c3c;color:#fff}
select{padding:6px;border-radius:6px}
</style>
</head>

<body>

<header>
<h2>â„ï¸ ADMIN PANEL â€“ SNOW</h2>
<button onclick="logout()">ÄÄƒng xuáº¥t</button>
</header>

<div class="container">

<div class="card">
<b>Lá»c Ä‘Æ¡n:</b>
<select id="filter" onchange="render()">
<option value="all">Táº¥t cáº£</option>
<option value="Äang lÃ m">Äang lÃ m</option>
<option value="HoÃ n tiá»n">HoÃ n tiá»n</option>
<option value="HoÃ n thÃ nh">HoÃ n thÃ nh</option>
</select>
</div>

<div class="card" id="orderList"></div>

</div>

<script>
// ğŸ” Báº¢O Vá»† ADMIN
if(localStorage.getItem("snow_admin")!=="true"){
  alert("âŒ KhÃ´ng cÃ³ quyá»n admin");
  location.href="index.html";
}

// DATA
let users  = JSON.parse(localStorage.snow_users  || "{}");
let orders = JSON.parse(localStorage.snow_orders || "[]");

function save(){
  localStorage.snow_users  = JSON.stringify(users);
  localStorage.snow_orders = JSON.stringify(orders);
}

// RENDER
function render(){
  const f = filter.value;
  orderList.innerHTML = "";

  orders.forEach((o,i)=>{
    if(f!=="all" && o.status!==f) return;

    orderList.innerHTML += `
      <div class="order">
        ğŸ‘¤ <b>${o.user}</b><br>
        ğŸ“¦ ${o.goi}<br>
        ğŸ’° ${o.price.toLocaleString()}Ä‘<br>
        ğŸ“Œ <b>${o.status}</b><br><br>

        ${o.status==="Äang lÃ m" ? `
          <button class="done" onclick="done(${i})">âœ” Duyá»‡t</button>
          <button class="refund" onclick="refund(${i})">â†© HoÃ n</button>
        `:""}
      </div>
    `;
  });

  if(orderList.innerHTML==="")
    orderList.innerHTML="<i>KhÃ´ng cÃ³ Ä‘Æ¡n</i>";
}

// DUYá»†T ÄÆ N
function done(i){
  orders[i].status="HoÃ n thÃ nh";
  save(); render();
  alert("âœ… ÄÃ£ duyá»‡t Ä‘Æ¡n");
}

// HOÃ€N TIá»€N
function refund(i){
  const o = orders[i];
  users[o.user].wallet += o.price;
  orders[i].status="HoÃ n tiá»n";
  save(); render();
  alert("â†© ÄÃ£ hoÃ n tiá»n");
}

// LOGOUT
function logout(){
  localStorage.removeItem("snow_admin");
  location.href="index.html";
}

render();
</script>
</body>
</html>
